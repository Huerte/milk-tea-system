{% extends 'base.html' %}

{% block title %}Enjoy Your Drink - Milk Tea System{% endblock %}

{% block content %}
<div class="enjoy-container">
    <h2><span class="material-icons" style="vertical-align: middle; font-size: 2rem;">celebration</span> Enjoy Your Drink!</h2>
    <p>Thank you for your order!</p>
    
    <div class="success-card">
        <div class="celebration">
            <div class="drink-emoji"><span class="material-icons" style="font-size: 4rem;">local_cafe</span></div>
            <div class="sparkles"><span class="material-icons" style="font-size: 2rem;">auto_awesome</span></div>
        </div>
        
        <h3>Order #{{ order.order_number }} Completed!</h3>
        
        <div class="completion-message">
            <p>We hope you enjoy your delicious milk tea!</p>
            <p>Your order has been marked as completed.</p>
        </div>
        
        <div class="order-recap">
            <h4>What you ordered:</h4>
            <ul>
                {% for item in order.items.all %}
                <li>
                    {{ item.quantity }}x {{ item.drink.name }} ({{ item.size.name }})
                    {% if item.flavor %} - {{ item.flavor.name }}{% endif %}
                    {% if item.toppings.exists %}
                        <br>With: {% for topping in item.toppings.all %}{{ topping.name }}{% if not forloop.last %}, {% endif %}{% endfor %}
                    {% endif %}
                </li>
                {% endfor %}
            </ul>
        </div>
        
        <div class="feedback-section">
            <h4>How was your experience?</h4>
            <div class="rating-stars">
                <span class="star" data-rating="1"><span class="material-icons">star_border</span></span>
                <span class="star" data-rating="2"><span class="material-icons">star_border</span></span>
                <span class="star" data-rating="3"><span class="material-icons">star_border</span></span>
                <span class="star" data-rating="4"><span class="material-icons">star_border</span></span>
                <span class="star" data-rating="5"><span class="material-icons">star_border</span></span>
            </div>
            <p id="rating-text">Click stars to rate!</p>
        </div>
        
        <div class="action-buttons">
            <a href="{% url 'browse_menu' %}" class="btn btn-secondary">
                <span class="material-icons">refresh</span> Order Again
            </a>
            <a href="{% url 'exit_website' %}" class="btn btn-primary">
                <span class="material-icons">logout</span> Exit System
            </a>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const stars = document.querySelectorAll('.star');
    const ratingText = document.getElementById('rating-text');
    
    stars.forEach(star => {
        star.addEventListener('click', function() {
            const rating = this.getAttribute('data-rating');
            

            stars.forEach(s => {
                s.classList.remove('selected');
                s.querySelector('.material-icons').textContent = 'star_border';
            });
            

            for (let i = 0; i < rating; i++) {
                stars[i].classList.add('selected');
                stars[i].querySelector('.material-icons').textContent = 'star';
            }
            

            const messages = {
                '1': 'Sorry to hear that! We\'ll do better next time.',
                '2': 'Thanks for the feedback!',
                '3': 'Good! Thanks for your order.',
                '4': 'Great! We\'re glad you enjoyed it.',
                '5': 'Excellent! Thanks for the 5-star rating!'
            };
            
            ratingText.textContent = messages[rating];
        });
    });
});
</script>
{% endblock %}
